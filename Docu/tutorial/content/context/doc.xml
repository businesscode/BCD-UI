<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../_generator/doc.xslt" media="screen" ?>
<!--
  Copyright 2010-2017 BusinessCode GmbH, Germany

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<Doc title="Application context and settings" xmlns="http://www.businesscode.de/schema/bcdui/doc-1.1.0">

  <Chapter title="Unified Expression Language" type="overview">
    <Body>
      The BCD-UI System uses the J2EE Unified Expression Language to put Server-side Values into
      XML documents at various places. With this feature it is possible to create for example
      request documents with the period set to the current month or year. This is especially
      useful when such a request document is based on the guiStatus and therefore bookmarkable,
      because the bookmark could contain a dynamically changed date.
    </Body>

    <SubChapter title="Usage scenarios">
      <Body>
        There are some XML documents where the EL can be used. These documents are described in
        the following sections.
        <dl>
          <dt>Request document / GuiStatus</dt>
          <dd>The request document can make use of the EL to fill in some values (usually filters)
              with server-side defaults.
              Example:
              <xml>
                <Status xmlns="http://www.businesscode.de/schema/bcdui/guiStatus-1.0.0">
                  <Filter xmlns="http://www.businesscode.de/schema/bcdui/filter-1.0.0">
                    <Expression bRef="date" op="=" value="${session.defaultDate}"/>
                  </Filter>
                </Status>
              </xml>
          </dd>

          <dt>WebRowSet Servlet</dt>
          <dd>This use case is applied when saving a WebRowSet on the server which should contain
              server-defined values. Example
              <xml>
                <Wrs xmlns="http://www.businesscode.de/schema/bcdui/wrs-1.0.0">
                  <RequestDocument/>
                  <Header>
                    <Columns>
                      <C pos="1"><BindingItem id="countryId"/></C>
                      <C pos="2"><BindingItem id="countryName"/></C>
                    </Columns>
                  </Header>
                  <Data>
                    <I>
                      <U>${bcdfn:generateId("dataIds")}</U>
                      <U>New Country</U>
                    </I>
                  </Data>
                </Wrs>
              </xml>
              In this WebRowSet the bcdfn:generateId function is used. This function generates a
              new ID (e.g. from an Oracle Sequence) for a certain scope (e.g. the name of the Sequence).
          </dd>

          <dt>Bindings</dt>
          <dd>The EL is used within the Bindings to set some default values for the Binding Items. These
              values are evaluated by the WebRowSet servlet or other Servlets using Bindings to set some
              default filters for columns. This technique makes it very easy to implement row-level
              security.</dd>
        </dl>
      </Body>
    </SubChapter>

    <SubChapter title="EL variables and functions">
      <Body>
        The EL context defined by BCDUI offers access to the "request" and "session" variables. If the
        EL occurs within an XML document it also defines a "document" variable pointing to the DOM
        document. These variables "request" and "session" variables work similar to the ones defined
        in JSP so that Expressions can be re-used. The context also contains the functions declared in
        webpage.tld to makes it even more compatible with JSP.
      </Body>
    </SubChapter>

    <SubChapter title="Using EL within custom servlets">
      <Body>
        It is also possible to use the Expression Language within custom code. To achieve this an object
        of the class <code>de.businesscode.bcdui.el.ELEnvironment</code> must be created and its
        <code>eval</code> method can then evaluate all EL expressions within a specified String.
      </Body>
    </SubChapter>

  </Chapter>

</Doc>