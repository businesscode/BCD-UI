<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../_generator/doc.xslt" media="screen" ?>
<!--
  Copyright 2010-2017 BusinessCode GmbH, Germany

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<doc:Doc title="JS, JSP, XML, XSLT Api" xmlns:doc="http://www.businesscode.de/schema/bcdui/doc-1.1.0">
  <doc:Chapter title="Apis" type="overview">
  <doc:Body>
    BCD-UI offers a variety of APIs for core, component, widget, widgetNg functionalities. The common basis of all APIs is javascript. So for example
    JSP tags or XSLT templates will call or generate javascript code.
    The following subchapters will show you some examples how to use the different APIs.<br/>
    <b>Please note that some auxiliary APIs may have technical restrictions.</b>
  </doc:Body>
    <doc:SubChapter title="JS" type="overview">
    <doc:Body>
      Javascript is commonly used in your HTML/JSP script blocks. It offers you access to all BCD-UI features.
      Keep in mind, within javascript the targetHtml attribute (e.g. used in components, widgets) is a required attribute. It's optional for other APIs (since they can generate their own target optionally).
      As an example, the following code will create a drop down chooser which takes its information from an automodel. It can be part of an HTML page's body element.
      <pre><![CDATA[<div id="myChooser"></div>
<script  type="text/javascript">
  var myDataModel = new bcdui.core.AutoModel({
    bindingSetId: "auto_test_wrs_oracle"
  , bRefs: "country"
  , isDistinct: true
  });
  bcdui.widgetNg.createSingleSelect({
    targetHtml: "myChooser"
  , targetModelXPath: "/*/f:Filter/f:Expression[@bRef = 'orig_country' and @op = '=']/@value"
  , optionsModelXPath: "$" + myDataModel.id + "//wrs:Data/wrs:R/wrs:C[1]"
  })
</script>]]></pre>
    </doc:Body>
    </doc:SubChapter>
    <doc:SubChapter title="JSP" type="overview">
    <doc:Body>
      Widgets, components, core objects and functionalities are also available as JSP tags. Let's take the previous javascript example in JSP tag syntax.
      Keep in mind, in  JSP, XSLT or XML environment you can reference objects via ids only. JSPs allow nesting of elements, too.
      You need to use taglib entries in your jsp to access the single tags. 
      <pre><![CDATA[
<%@ taglib uri="http://de.businesscode.web/jsp/taglib/bcdui/bcdui" prefix="b"%>
<%@ taglib uri="http://de.businesscode.web/jsp/taglib/bcdui/widgetNg" prefix="wNg"%>

<b:autoModel id="myDataModel"
  bindingSetId="auto_test_wrs_oracle"
  bindingItemRefs="country"
  isDistinct="true"/>

<wNg:singleSelect
  targetModelXPath="/*/f:Filter/f:Expression[@bRef = 'orig_country' and @op = '=']/@value"
  optionsModelXPath="$myDataModel//wrs:Data/wrs:R/wrs:C[1]"/>]]></pre>
      The target HTML position - if not specified - is automatically generated at the position where you place your tag. So if you placed your container div
      manually elsewhere you might use the following for the singleSelect tag:
     <pre><![CDATA[
<div id="myChooser"></div>
<wNg:singleSelect
  targetHtml="myChooser"
  targetModelXPath="/*/f:Filter/f:Expression[@bRef = 'orig_country' and @op = '=']/@value"
  optionsModelXPath="$myDataModel//wrs:Data/wrs:R/wrs:C[1]"/>]]></pre>
    </doc:Body>
    </doc:SubChapter>
    <doc:SubChapter title="XSLT" type="overview">
    <doc:Body>
      <p>
        <b>Restrictions</b>
        <ul>
          <li>It is not possible to use core:modelUpdater on the guiStatus to initially transform it. Please use either JS or JSP API for that purpose.</li>
          <li>Following widgets from /bcdui/js/widget/widget.xslt are not available in this API: blindUpDown, loginForm, userMessagesEditor, userMessagesViewer</li>
        </ul>
      </p>
      For using the XSLT API we include a renderer in our page which handles the transformation of the stylesheet holding the single API template calls.
      Such renderer code in jsp can look like this: 
     <pre><![CDATA[<%@ taglib uri="http://de.businesscode.web/jsp/taglib/bcdui/bcdui" prefix="b"%>
<div id="xsltArea"><div>
<b:renderer stylesheetUrl="renderer.xslt" targetHtml="xsltArea"/>
]]></pre>
      <p>
        And our example stylesheet renderer.xslt file looks like this:
      </p>
    <doc:xml>
      <xsl:stylesheet
        xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
        <xsl:import href="../../bcdui/js/core/core.xslt"/>
        <xsl:import href="../../bcdui/js/widgetNg/widgetNg.xslt"/>
        <xsl:output method="html" encoding="UTF-8" indent="yes"/>

        <xsl:template match="/*">
          <div>
            <xsl:call-template name="autoModel">
              <xsl:with-param name="id" select="'myDataModel'"/>
              <xsl:with-param name="bindingSetId" select="'auto_test_wrs_oracle'"/>
              <xsl:with-param name="bindingItemRefs" select="'country'"/>
              <xsl:with-param name="isDistinct" select="'true'"/>
            </xsl:call-template>
            <xsl:call-template name="singleSelectNg">
              <xsl:with-param name="targetModelXPath">/*/f:Filter/f:Expression[@bRef= 'orig_country' and @op = '=']/@value</xsl:with-param>
              <xsl:with-param name="optionsModelXPath">$myDataModel//wrs:Data/wrs:R/wrs:C[1]</xsl:with-param>
            </xsl:call-template>
          </div>
        </xsl:template>
      </xsl:stylesheet>
    </doc:xml>
    As you see in the example, you need to use import API xslts (core.xslt, component.xslt, widget.xslt, widgetNg.xslt) to make use of the templates.
    </doc:Body>
    </doc:SubChapter>
    <doc:SubChapter title="XML" type="overview">
    <doc:Body>
      <p>
        <b>Restrictions</b>:
        <ul>
          <li>It is not possible to use core:modelUpdater on the guiStatus to initially transform it. Please use either JS or JSP API for that purpose.</li>
          <li>Following widgets from /bcdui/js/widget/widget.xslt are not available in this API: BlindUpDown, LoginForm, UserMessagesEditor, UserMessagesViewer</li>
          <li>Recommended way for XML API is to use the inputModel on the transformator when generating.</li>
        </ul>
      </p>
      For the XML Api, you can define your objects in an XML file. We will use a helper xslt tranformation which simply applies the listed elements.
      Renderer code in jsp can look like this: 
     <pre><![CDATA[<%@ taglib uri="http://de.businesscode.web/jsp/taglib/bcdui/bcdui" prefix="b"%>
<div id="xmlArea"><div>
<b:renderer stylesheetUrl="apply.xslt" targetHtml="xmlArea">
  <b:model url="elements.xml"/>
</b:renderer>]]></pre>
      And our helper stylesheet apply.xslt file looks like this:
      <doc:xml>
        <xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
          <xsl:import href="../../bcdui/js/core/core.xslt"/>
          <xsl:import href="../../bcdui/js/widgetNg/widgetNg.xslt"/>
          <xsl:output method="html" version="1.0" encoding="UTF-8" indent="no"/>
          <xsl:template match="/*">
            <div>
              <xsl:for-each select="*">
                <xsl:apply-templates select="."/>
              </xsl:for-each>
            </div>
          </xsl:template>
        </xsl:stylesheet>
      </doc:xml>
And finally our example stylesheet elements.xml file looks like this:
    <doc:xml>
      <Root>
        <AutoModel xmlns="http://www.businesscode.de/schema/bcdui/xmlapi-1.0.0"
        id="myDataModel"
        bindingSetId="auto_test_wrs_oracle"
        isDistinct="true"
        bindingItemRefs="country" />
        <SingleSelectNg targetModelXPath="/*/f:Filter/f:Expression[@bRef= 'orig_country' and @op = '=']/@value"
        optionsModelXPath="$myDataModel//wrs:Data/wrs:R/wrs:C[1]"/>        
      </Root>
    </doc:xml>
    As you see in the example, the helper xslt imports API xslts (core.xslt, component.xslt, widget.xslt, widgetNg.xslt) to make use of the templates.
    </doc:Body>
    </doc:SubChapter>
  </doc:Chapter>
</doc:Doc>
