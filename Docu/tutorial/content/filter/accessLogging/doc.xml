<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../../../_generator/doc.xslt" media="screen" ?>
<!--
  Copyright 2010-2017 BusinessCode GmbH, Germany

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<Doc title="Access Logging" xmlns="http://www.businesscode.de/schema/bcdui/doc-1.1.0" state="draft">
  <!--
    TODO
    - Is userAgent enough information?
  -->
  <Chapter title="Access Logging Overview" type="overview">
    <Body>
      Often it is desirable to keep track of the application usage.
      This allows for example to control the success of a roll-out as well as detecting usage patterns for performance or functionality improvements.
      BCD-UI allows for easy setup of access logging for interesting parts. The access log is written to a special database table for later evaluation.
      Where needed the information from the AccessLogFilter can be linked to session information captured by the <a href="../../security/doc.xml">SecurityFilter</a>.
    </Body>

    <SubChapter title="AccessLogFilter">
      <Body>
        The AccessLogFilter will keep track of requests to pages and data.
        It allows to be assigned to URL patterns with standard entries in web.xml
        The filter will write the full request parameters in to the access login table.
        The access logging table holds the following entries:

        <table class="propertyList">
          <tr><th>Column</th><th>Content</th></tr>
          <tr><td>StartTimestamp</td><td>time of start of request</td></tr>
          <tr><td>EndTimestamp</td><td>time of finishing of request</td></tr>
          <tr><td>SessionId</td><td>Id of the user's session.</td></tr>
          <tr><td>PageRequestHash</td><td>Each request page is assigned an individual number to hold all requests of the page together.</td></tr>
          <tr><td>RequestUrl</td><td>URL of the request</td></tr>
          <tr><td>RequestXml</td><td>Request document in plain xml</td></tr>
          <tr><td>RowCount</td><td>If applies, the number of Wrs rows returned</td></tr>
          <tr><td>ColCount</td><td>If applies, the number of Wrs columns returned</td></tr>
          <tr><td>Referrer</td><td>From HTML header</td></tr>
        </table>

        If the application is shut down, remaining requests are written, if the application is killed, remaining request get lost.
        <div/>
        Sample configuration:
        <xml>
          <filter>
            <filter-class>de.businesscode.bcdui.web.accessLogging.AccessLogFilter</filter-class>
            <filter-name>AccessLogFilter</filter-name>
            <init-param>
              <param-name>TableName</param-name>
              <param-value>tb_fe_acclogging</param-value>
            </init-param>
          </filter>
          <filter-mapping>
            <filter-name>AccessLogFilter</filter-name>
            <url-pattern>/*</url-pattern>
          </filter-mapping>
        </xml>
      </Body>
    </SubChapter>
  </Chapter>
</Doc>